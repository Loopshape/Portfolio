(function(e){e.fn.extend({elastic:function(){var t=["paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","lineHeight","fontFamily","width","-moz-box-sizing","box-sizing","-webkit-box-sizing","padding-top","padding-bottom","fontWeight","border-top-width","border-right-width","border-bottom-width","border-left-width","borderTopStyle","borderTopColor","borderRightStyle","borderRightColor","borderBottomStyle","borderBottomColor","borderLeftStyle","borderLeftColor"];return this.each(function(){function m(){var e=Math.floor(parseInt(r.width(),10)-parseInt(u,10));if(c.width()!==e){c.css({width:e+"px"});y(true)}}function g(e,t){var n=Math.floor(parseInt(e,10)+parseInt(o,10));if(r.height()!==n){r.css({height:n+"px",overflow:t})}}function y(e){var t=r.val().replace(/&/g,"&").replace(/ {2}/g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />");var o=0,a=0;var f=c.html().replace(/<br>/ig,"<br />");if(e||t+"&nbsp;"!==f){c.html(t+"&nbsp;");var l=r.width();if(n=="border-box"){l=parseInt(l+parseInt(u,10));c.css({width:l+"px"})}else{c.css({width:l+"px"})}o=c.height();a=r.height()-4;if(Math.abs(o+i-a)>3){var p=o;if(p>=h){g(h,"auto")}else if(p<=s){g(s,"hidden")}else{g(p,"hidden")}}}}if(this.type!=="textarea"){return false}var n="";var r=e(this),i=parseInt(r.css("line-height"),10)||parseInt(r.css("font-size"),"10"),s=parseInt(r.css("height"),10)||i*3,o=0,u=0;var a=r.css("display");var f=e().jquery;var l=f.split(".");f=parseInt(l[1]);if(r.css("-moz-box-sizing")){n=r.css("-moz-box-sizing")}else if(r.css("box-sizing")){n=r.css("box-sizing")}else if(r.css("-webkit-box-sizing")){n=r.css("-webkit-box-sizing")}if(n=="border-box"){o=parseInt(r.css("padding-bottom"),10)+parseInt(r.css("padding-top"),10)+parseInt(r.css("border-top-width"),10)+parseInt(r.css("border-bottom-width"),10);s=s-o}else{}u=parseInt(r.css("padding-right"),10)+parseInt(r.css("padding-left"),10)+parseInt(r.css("border-right-width"),10)+parseInt(r.css("border-left-width"),10);var c=e("<div />").css({position:"absolute",display:"none","word-wrap":"break-word","white-space":"pre-wrap"});var h=parseInt(r.css("max-height"),10)||Number.MAX_VALUE,p=0;if(h<0){h=Number.MAX_VALUE}c.appendTo(r.parent());var d=t.length;while(d--){if(r.css(t[d].toString())){c.css(t[d].toString(),r.css(t[d].toString()))}}var v=r.width();if(n=="border-box"){v=parseInt(v+parseInt(u,10));c.css({width:v+"px"})}else{v=parseInt(v-parseInt(u,10));c.css({width:v+"px"})}r.css({overflow:"hidden"});r.bind("keyup change cut paste",function(){y()});e(window).bind("resize",m);r.bind("resize",m);r.bind("update",y);r.bind("blur",function(){var e=c.height();if(f<8){e=c.height()+o}if(e<h){if(e>s){r.height(e)}else{r.height(s)}}});r.bind("input paste",function(e){setTimeout(y,250)});y()})}})})(jQuery)